# RAGシステム アーキテクチャ設計

LangGraphで実装する運用向けRAGシステムのアーキテクチャ設計ドキュメント。

## 概要

本システムは3つの主要パイプラインで構成される。

## パイプライン一覧

| パイプライン | ドキュメント | 説明 |
|-------------|-------------|------|
| 検索パイプライン | [query-pipeline.md](./query-pipeline.md) | ユーザークエリを処理し、関連ドキュメントを検索して回答を生成 |
| インデックス作成パイプライン | [indexing-pipeline.md](./indexing-pipeline.md) | ドキュメントをチャンク化、ベクトル化してインデックスに登録 |
| 更新パイプライン | [update-pipeline.md](./update-pipeline.md) | 既存インデックスの更新、ゴーストデータ削除、ホット/コールド移行 |

## 運用ドキュメント

| ドキュメント | 説明 |
|-------------|------|
| [operations.md](./operations.md) | 監視メトリクス、アラート条件、ダッシュボード設計 |

## SLA/SLO

### 可用性

| 項目 | 目標 |
|------|------|
| 月間稼働率 | 99.5%（月間ダウンタイム: 約3.6時間以内） |
| 計画メンテナンス | 月1回、最大2時間（事前通知必須） |

### レイテンシ（検索パイプライン）

| パーセンタイル | 目標 | 備考 |
|---------------|------|------|
| P50 | 2秒以内 | 通常リクエストの半数 |
| P95 | 5秒以内 | ほとんどのリクエスト |
| P99 | 10秒以内 | 極端なケースを除く |

※ 複雑なクエリ（HyDE使用、Web検索フォールバック）は上記を超える場合あり

### スループット

| 項目 | 目標 |
|------|------|
| 同時リクエスト | 100 req/s |
| 日間リクエスト | 最大500万件 |

### エラーバジェット

| 項目 | 許容範囲 |
|------|---------|
| エラー率 | 月間 0.5% 以内 |
| 「回答不可」率 | 月間 5% 以内 |

※ エラーバジェット超過時はリリース凍結、安定化優先

## 技術スタック（参考）

| カテゴリ | 推奨技術 |
|---------|---------|
| フレームワーク | LangGraph |
| 埋め込みモデル | ruri-v3-310m（日本語特化、JMTEBでSOTA） |
| ベクトルDB | Qdrant / Weaviate |
| 全文検索 | Elasticsearch (BM25) |
| Reranker | TBD |
| 評価 | RAGAS + Langfuse |
